!function(root,factory){"use strict";"function"==typeof define&&define.amd?define([],factory):"object"==typeof module&&module.exports?module.exports=factory(require("xmldom").DOMParser):root.X2JS=factory()}(this,function(CustomDOMParser){"use strict";return function(config){function initConfigDefaults(){config.arrayAccessForm=config.arrayAccessForm||"none",config.emptyNodeForm=config.emptyNodeForm||"text",config.attributeConverters=config.attributeConverters||[],config.datetimeAccessFormPaths=config.datetimeAccessFormPaths||[],config.arrayAccessFormPaths=config.arrayAccessFormPaths||[],void 0===config.enableToStringFunc&&(config.enableToStringFunc=!0),void 0===config.skipEmptyTextNodesForObj&&(config.skipEmptyTextNodesForObj=!0),void 0===config.stripWhitespaces&&(config.stripWhitespaces=!0),void 0===config.useDoubleQuotes&&(config.useDoubleQuotes=!0),void 0===config.ignoreRoot&&(config.ignoreRoot=!1),void 0===config.escapeMode&&(config.escapeMode=!0),void 0===config.attributePrefix&&(config.attributePrefix="_"),void 0===config.selfClosingElements&&(config.selfClosingElements=!0),void 0===config.keepCData&&(config.keepCData=!1)}function initRequiredPolyfills(){function pad(number){var r=String(number);return 1===r.length&&(r="0"+r),r}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){var MS_IN_S=1e3;return this.getUTCFullYear()+"-"+pad(this.getUTCMonth()+1)+"-"+pad(this.getUTCDate())+"T"+pad(this.getUTCHours())+":"+pad(this.getUTCMinutes())+":"+pad(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/MS_IN_S).toFixed(3)).slice(2,5)+"Z"})}function getDomNodeLocalName(domNode){var localName=domNode.localName;return null==localName&&(localName=domNode.baseName),null!=localName&&""!==localName||(localName=domNode.nodeName),localName}function getDomNodeNamespacePrefix(node){return node.prefix}function escapeXmlChars(str){return"string"==typeof str?str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):str}function unescapeXmlChars(str){return str.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")}function ensureProperArrayAccessForm(element,childName,elementPath){switch(config.arrayAccessForm){case"property":element[childName]instanceof Array?element[childName+"_asArray"]=element[childName]:element[childName+"_asArray"]=[element[childName]]}if(!(element[childName]instanceof Array)&&config.arrayAccessFormPaths.length>0){for(var match=!1,i=0;i<config.arrayAccessFormPaths.length;i++){var arrayPath=config.arrayAccessFormPaths[i];if("string"==typeof arrayPath){if(arrayPath===elementPath){match=!0;break}}else if(arrayPath instanceof RegExp){if(arrayPath.test(elementPath)){match=!0;break}}else if("function"==typeof arrayPath&&arrayPath(childName,elementPath)){match=!0;break}}match&&(element[childName]=[element[childName]])}}function xmlDateTimeToDate(prop){var MINUTES_PER_HOUR=60,bits=prop.split(/[-T:+Z]/g),d=new Date(bits[0],bits[1]-1,bits[2]),secondBits=bits[5].split(".");if(d.setHours(bits[3],bits[4],secondBits[0]),secondBits.length>1&&d.setMilliseconds(secondBits[1]),bits[6]&&bits[7]){var offsetMinutes=bits[6]*MINUTES_PER_HOUR+Number(bits[7]),sign=/\d\d-\d\d:\d\d$/.test(prop)?"-":"+";offsetMinutes=0+("-"===sign?-1*offsetMinutes:offsetMinutes),d.setMinutes(d.getMinutes()-offsetMinutes-d.getTimezoneOffset())}else prop.indexOf("Z",prop.length-1)!==-1&&(d=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds())));return d}function convertToDateIfRequired(value,childName,fullPath){if(config.datetimeAccessFormPaths.length>0)for(var pathWithoutTextNode=fullPath.split(".#")[0],i=0;i<config.datetimeAccessFormPaths.length;i++){var candidatePath=config.datetimeAccessFormPaths[i];if("string"==typeof candidatePath){if(candidatePath===pathWithoutTextNode)return xmlDateTimeToDate(value)}else if(candidatePath instanceof RegExp){if(candidatePath.test(pathWithoutTextNode))return xmlDateTimeToDate(value)}else if("function"==typeof candidatePath&&candidatePath(pathWithoutTextNode))return xmlDateTimeToDate(value)}return value}function deserializeRootElementChildren(rootElement){for(var result={},children=rootElement.childNodes,i=0;i<children.length;i++){var child=children.item(i);if(child.nodeType===DOMNodeTypes.ELEMENT_NODE){var childName=getDomNodeLocalName(child);config.ignoreRoot?result=deserializeDomChildren(child,childName):result[childName]=deserializeDomChildren(child,childName)}}return result}function deserializeElementChildren(element,elementPath){var result={};result.__cnt=0;for(var nodeChildren=element.childNodes,iChild=0;iChild<nodeChildren.length;iChild++){var child=nodeChildren.item(iChild),childName=getDomNodeLocalName(child);child.nodeType!==DOMNodeTypes.COMMENT_NODE&&(result.__cnt++,null==result[childName]?(result[childName]=deserializeDomChildren(child,elementPath+"."+childName),ensureProperArrayAccessForm(result,childName,elementPath+"."+childName)):(result[childName]instanceof Array||(result[childName]=[result[childName]],ensureProperArrayAccessForm(result,childName,elementPath+"."+childName)),result[childName][result[childName].length]=deserializeDomChildren(child,elementPath+"."+childName)))}for(var iAttribute=0;iAttribute<element.attributes.length;iAttribute++){var attribute=element.attributes.item(iAttribute);result.__cnt++;for(var adjustedValue=attribute.value,iConverter=0;iConverter<config.attributeConverters.length;iConverter++){var converter=config.attributeConverters[iConverter];converter.test.call(null,attribute.name,attribute.value)&&(adjustedValue=converter.convert.call(null,attribute.name,attribute.value))}result[config.attributePrefix+attribute.name]=adjustedValue}var namespacePrefix=getDomNodeNamespacePrefix(element);return namespacePrefix&&(result.__cnt++,result.__prefix=namespacePrefix),result["#text"]&&(result.__text=result["#text"],result.__text instanceof Array&&(result.__text=result.__text.join("\n")),config.escapeMode&&(result.__text=unescapeXmlChars(result.__text)),config.stripWhitespaces&&(result.__text=result.__text.trim()),delete result["#text"],"property"===config.arrayAccessForm&&delete result["#text_asArray"],result.__text=convertToDateIfRequired(result.__text,"#text",elementPath+".#text")),result.hasOwnProperty("#cdata-section")&&(result.__cdata=result["#cdata-section"],delete result["#cdata-section"],"property"===config.arrayAccessForm&&delete result["#cdata-section_asArray"]),1===result.__cnt&&result.__text?result=result.__text:0===result.__cnt&&"text"===config.emptyNodeForm?result="":result.__cnt>1&&void 0!==result.__text&&config.skipEmptyTextNodesForObj&&(config.stripWhitespaces&&""===result.__text||""===result.__text.trim())&&delete result.__text,delete result.__cnt,config.keepCData||result.hasOwnProperty("__text")||!result.hasOwnProperty("__cdata")?(config.enableToStringFunc&&(result.__text||result.__cdata)&&(result.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),result):result.__cdata?result.__cdata:""}function deserializeDomChildren(node,parentPath){return node.nodeType===DOMNodeTypes.DOCUMENT_NODE?deserializeRootElementChildren(node):node.nodeType===DOMNodeTypes.ELEMENT_NODE?deserializeElementChildren(node,parentPath):node.nodeType===DOMNodeTypes.TEXT_NODE||node.nodeType===DOMNodeTypes.CDATA_SECTION_NODE?node.nodeValue:null}function serializeStartTag(jsObject,elementName,attributeNames,selfClosing){var resultStr="<"+(jsObject&&jsObject.__prefix?jsObject.__prefix+":":"")+elementName;if(attributeNames)for(var i=0;i<attributeNames.length;i++){var attributeName=attributeNames[i],attributeValue=jsObject[attributeName];config.escapeMode&&(attributeValue=escapeXmlChars(attributeValue)),resultStr+=" "+attributeName.substr(config.attributePrefix.length)+"=",resultStr+=config.useDoubleQuotes?'"'+attributeValue+'"':"'"+attributeValue+"'"}return resultStr+=selfClosing?" />":">"}function serializeEndTag(jsObject,elementName){return"</"+(jsObject&&jsObject.__prefix?jsObject.__prefix+":":"")+elementName+">"}function endsWith(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1}function isSpecialProperty(jsonObj,propertyName){return!!("property"===config.arrayAccessForm&&endsWith(propertyName.toString(),"_asArray")||0===propertyName.toString().indexOf(config.attributePrefix)||0===propertyName.toString().indexOf("__")||jsonObj[propertyName]instanceof Function)}function getDataElementCount(jsObject){var count=0;if(jsObject instanceof Object)for(var propertyName in jsObject)isSpecialProperty(jsObject,propertyName)||count++;return count}function getDataAttributeNames(jsObject){var names=[];if(jsObject instanceof Object)for(var attributeName in jsObject)attributeName.toString().indexOf("__")===-1&&0===attributeName.toString().indexOf(config.attributePrefix)&&names.push(attributeName);return names}function serializeComplexTextNodeContents(textNode){var result="";return textNode.__cdata&&(result+="<![CDATA["+textNode.__cdata+"]]>"),textNode.__text&&(result+=config.escapeMode?escapeXmlChars(textNode.__text):textNode.__text),result}function serializeTextNodeContents(textNode){var result="";return textNode instanceof Object?result+=serializeComplexTextNodeContents(textNode):textNode&&(result+=config.escapeMode?escapeXmlChars(textNode):textNode),result}function serializeArray(elementArray,elementName,attributes){var result="";if(0===elementArray.length)result+=serializeStartTag(elementArray,elementName,attributes,!0);else for(var i=0;i<elementArray.length;i++)result+=serializeJavaScriptObject(elementArray[i],elementName,getDataAttributeNames(elementArray[i]));return result}function serializeJavaScriptObject(element,elementName,attributes){var result="";if(void 0!==element&&null!==element&&""!==element||!config.selfClosingElements)if("object"==typeof element)if("[object Array]"===Object.prototype.toString.call(element))result+=serializeArray(element,elementName,attributes);else if(element instanceof Date)result+=serializeStartTag(element,elementName,attributes,!1),result+=element.toISOString(),result+=serializeEndTag(element,elementName);else{var childElementCount=getDataElementCount(element);childElementCount>0||element.__text||element.__cdata?(result+=serializeStartTag(element,elementName,attributes,!1),result+=serializeJavaScriptObjectChildren(element),result+=serializeEndTag(element,elementName)):config.selfClosingElements?result+=serializeStartTag(element,elementName,attributes,!0):(result+=serializeStartTag(element,elementName,attributes,!1),result+=serializeEndTag(element,elementName))}else result+=serializeStartTag(element,elementName,attributes,!1),result+=serializeTextNodeContents(element),result+=serializeEndTag(element,elementName);else result+=serializeStartTag(element,elementName,attributes,!0);return result}function serializeJavaScriptObjectChildren(jsObject){var result="",elementCount=getDataElementCount(jsObject);if(elementCount>0)for(var elementName in jsObject)if(!isSpecialProperty(jsObject,elementName)){var element=jsObject[elementName],attributes=getDataAttributeNames(element);result+=serializeJavaScriptObject(element,elementName,attributes)}return result+=serializeTextNodeContents(jsObject)}function parseXml(xml){if(void 0===xml)return null;if("string"!=typeof xml)return null;var parser=null,domNode=null;if(CustomDOMParser)parser=new CustomDOMParser,domNode=parser.parseFromString(xml,"text/xml");else if(window&&window.DOMParser){parser=new window.DOMParser;var parsererrorNS=null,isIEParser=window.ActiveXObject||"ActiveXObject"in window;if(!isIEParser)try{parsererrorNS=parser.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(err){parsererrorNS=null}try{domNode=parser.parseFromString(xml,"text/xml"),null!==parsererrorNS&&domNode.getElementsByTagNameNS(parsererrorNS,"parsererror").length>0&&(domNode=null)}catch(err){domNode=null}}else 0===xml.indexOf("<?")&&(xml=xml.substr(xml.indexOf("?>")+2)),domNode=new ActiveXObject("Microsoft.XMLDOM"),domNode.async="false",domNode.loadXML(xml);return domNode}var VERSION="2.0.1";config=config||{},initConfigDefaults(),initRequiredPolyfills();var DOMNodeTypes={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.asArray=function(prop){return void 0===prop||null===prop?[]:prop instanceof Array?prop:[prop]},this.toXmlDateTime=function(dt){return dt instanceof Date?dt.toISOString():"number"==typeof dt?new Date(dt).toISOString():null},this.asDateTime=function(prop){return"string"==typeof prop?xmlDateTimeToDate(prop):prop},this.xml2dom=function(xml){return parseXml(xml)},this.dom2js=function(domNode){return deserializeDomChildren(domNode,null)},this.js2dom=function(jsObject){var xml=this.js2xml(jsObject);return parseXml(xml)},this.xml2js=function(xml){var domNode=parseXml(xml);return null!=domNode?this.dom2js(domNode):null},this.js2xml=function(jsObject){return serializeJavaScriptObjectChildren(jsObject)},this.getVersion=function(){return VERSION}}});
//# sourceMappingURL=x2js.min.js.map
